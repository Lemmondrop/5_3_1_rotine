# 5/3/1 Routine Generator

## 프로젝트 개요

본 프로젝트는 `kakaocorp/kanana-nano-2.1b-instruct` 모델을 기반으로,  
사용자 정보(데드리프트, 벤치프레스, 스쿼트, 오버헤드 프레스 1RM, 운동 경험, 운동 목표)를 입력받아  
**요일별 5/3/1 운동 루틴**을 생성하는 기능을 제공합니다.

## 사용한 모델

- `kakaocorp/kanana-nano-2.1b-instruct`

## 학습 방식

- LoRA (Low-Rank Adaptation)
- PEFT (Parameter-Efficient Fine-Tuning)

## 학습 환경

- 운영체제: Windows 10  
- CPU: Intel i7-12700K  
- GPU: NVIDIA RTX 4080  
- RAM: 64GB (DDR5)

## 학습 데이터 구성 전략

### 데이터 구조

- 총 5,000개의 데이터 샘플
- JSON 형식: `instruction`, `input`, `output`
- 목적: 사용자 입력 → 요일별 5/3/1 세트 루틴 생성

### 계산 방식

세트 구성 참조:  
https://www.monandol.kr/29/?bmode=view&idx=25307181

- 훈련 1RM = 실제 1RM × 0.9  
- 세트 구성 예시:
  - 1주차: 65% × 5회, 75% × 5회, 85% × 5회 이상 (AMRAP)
  - 2주차: 70% × 3회, 80% × 3회, 90% × 3회 이상
  - 3주차: 75% × 5회, 85% × 3회, 95% × 1회 이상
- 각 중량은 헬스장 환경에 맞춰 **2.5kg 단위로 반올림**
- 출력에는 **계산식, 반올림된 결과, 반복 수(혹은 AMRAP)**를 포함

### 출력 스타일

- 자연어보다는 **규칙 기반 및 수식 기반의 포맷**
- 고정된 요일 구성:
  - 월: 벤치프레스
  - 화: 스쿼트
  - 목: 오버헤드 프레스
  - 금: 데드리프트
- 마크다운 형식 사용 유도

## 학습 데이터 예시

```json
{"instruction": "아래 사용자 정보를 참고하여 정확한 5/3/1 규칙에 따라 루틴을 작성하세요. 반드시 다음 요소를 포함하세요:\n1. 1RM의 90%를 훈련 1RM으로 계산하고 이를 기준으로 사용\n2. 각 주차별 세트 구성: 65/75/85 → 70/80/90 → 75/85/95\n3. 2.5kg 단위로 반올림된 실제 중량과 계산 과정을 명시\n4. 주당 요일 수(예: 3일 루틴)에 맞는 날짜별 구성\n가능하면 각 운동은 마크다운 형식으로 출력하세요.", 
"input": "운동 경험: 숙련자\n운동 목표: 체중 증가\n운동 가능일: 주 3일\n1RM 정보: 스쿼트 125.0kg, 벤치프레스 85.0kg, 데드리프트 110.0kg, 오버헤드 프레스 25.0kg", 
"output": "[훈련 1RM 계산 결과]\n- 스쿼트: 1RM 125.0kg × 0.9 = 112.5kg → 112.5kg\n- 벤치프레스: 1RM 85.0kg × 0.9 = 76.5kg → 77.5kg\n- ..."}
{"instruction": "아래 사용자 정보를 참고하여 정확한 5/3/1 규칙에 따라 루틴을 작성하세요. 반드시 다음 요소를 포함하세요:\n1. 1RM의 90%를 훈련 1RM으로 계산하고 이를 기준으로 사용\n2. 각 주차별 세트 구성: 65/75/85 → 70/80/90 → 75/85/95\n3. 2.5kg 단위로 반올림된 실제 중량과 계산 과정을 명시\n4. 주당 요일 수(예: 3일 루틴)에 맞는 날짜별 구성\n가능하면 각 운동은 마크다운 형식으로 출력하세요.", 
"input": "운동 경험: 초보자\n운동 목표: 체중 증가\n운동 가능일: 주 3일\n1RM 정보: 스쿼트 100.0kg, 벤치프레스 52.5kg, 데드리프트 175.0kg, 오버헤드 프레스 30.0kg", 
"output": "[훈련 1RM 계산 결과]\n- 스쿼트: 1RM 100.0kg × 0.9 = 90.0kg → 90.0kg\n- 벤치프레스: 1RM 52.5kg × 0.9 = 47.2kg → 47.5kg\n- ..."}
{"instruction": "아래 사용자 정보를 참고하여 정확한 5/3/1 규칙에 따라 루틴을 작성하세요. 반드시 다음 요소를 포함하세요:\n1. 1RM의 90%를 훈련 1RM으로 계산하고 이를 기준으로 사용\n2. 각 주차별 세트 구성: 65/75/85 → 70/80/90 → 75/85/95\n3. 2.5kg 단위로 반올림된 실제 중량과 계산 과정을 명시\n4. 주당 요일 수(예: 3일 루틴)에 맞는 날짜별 구성\n가능하면 각 운동은 마크다운 형식으로 출력하세요.", 
"input": "운동 경험: 중급자\n운동 목표: 체지방 감소\n운동 가능일: 주 3일\n1RM 정보: 스쿼트 127.5kg, 벤치프레스 90.0kg, 데드리프트 157.5kg, 오버헤드 프레스 25.0kg", 
"output": "[훈련 1RM 계산 결과]\n- 스쿼트: 1RM 127.5kg × 0.9 = 114.8kg → 115.0kg\n- 벤치프레스: 1RM 90.0kg × 0.9 = 81.0kg → 80.0kg\n- ..."}
```

## 예시 사용자 루틴

사용자 정보:

- 운동 경험: 중급자  
- 운동 목표: 근력 증가  
- 1RM 정보:  
  - 스쿼트: 100kg  
  - 벤치프레스: 80kg  
  - 데드리프트: 140kg  
  - 오버헤드 프레스: 60kg  

[1주차 루틴]

**월요일 - 벤치프레스**
- 1세트 (65% × 5회): 80.0 × 0.9 × 0.65 = 46.8kg → 47.5kg  
- 2세트 (75% × 5회): 80.0 × 0.9 × 0.75 = 54.0kg → 55kg  
- 3세트 (85% × AMRAP): 80.0 × 0.9 × 0.85 = 61.2kg → 60kg  

**화요일 - 스쿼트**
- 1세트 (65% × 5회): 100.0 × 0.9 × 0.65 = 58.5kg → 57.5kg  
- 2세트 (75% × 5회): 100.0 × 0.9 × 0.75 = 67.5kg → 67.5kg  
- 3세트 (85% × AMRAP): 100.0 × 0.9 × 0.85 = 76.5kg → 77.5kg  

**수요일 - 휴식**

**목요일 - 오버헤드 프레스**
- 1세트 (65% × 5회): 60.0 × 0.9 × 0.65 = 35.1kg → 35kg  
- 2세트 (75% × 5회): 60.0 × 0.9 × 0.75 = 40.5kg → 40kg  
- 3세트 (85% × AMRAP): 60.0 × 0.9 × 0.85 = 45.9kg → 45kg  

**금요일 - 데드리프트**
- 1세트 (65% × 5회): 140.0 × 0.9 × 0.65 = 81.9kg → 82.5kg  
- 2세트 (75% × 5회): 140.0 × 0.9 × 0.75 = 94.5kg → 95kg  
- 3세트 (85% × AMRAP): 140.0 × 0.9 × 0.85 = 107.1kg → 107.5kg  

...

[4주차 루틴] 포함하여 전체 주차 계획 생성

루틴 전체 예시:  
[https://github.com/Lemmondrop/5_3_1_rotine/blob/main/531_routine.md](https://github.com/Lemmondrop/5_3_1_rotine/blob/main/531_routine.md)

## 실행 방법

```bash
python inference.py
```

- `inference.py` 실행 시 `사용자의 정보{user_info}`입력받음
[입력예시]
```bash
✅ 사용자 정보를 입력하세요.

운동 경험 (예: 초급자 / 중급자 / 고급자): 초급자
운동 목표 (예: 근력 증가 / 유지 / 다이어트): 근력 증가
스쿼트 1RM (kg): 60
벤치프레스 1RM (kg): 40
데드리프트 1RM (kg): 40
오버헤드 프레스 1RM (kg): 20
```

## 모델 파일 또는 접근 경로
results_kanana_v2/checkpoint-1250
